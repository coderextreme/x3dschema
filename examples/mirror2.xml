<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE X3D
  PUBLIC "ISO//Web3D//DTD X3D 4.0//EN" "https://www.web3d.org/specifications/x3d-4.0.dtd">
<X3D xmlns:xsd="http://www.w3.org/2001/XMLSchema-instance"
      profile="Immersive"
      version="4.0"
      xsd:noNamespaceSchemaLocation="https://www.web3d.org/specifications/x3d-4.0.xsd">
   <head>
      <component level="1" name="Scripting"/>
      <component level="3" name="EnvironmentalEffects"/>
      <component level="1" name="Shaders"/>
      <component level="1" name="CubeMapTexturing"/>
      <component level="1" name="Texturing"/>
      <component level="1" name="Rendering"/>
      <component level="4" name="Shape"/>
      <component level="3" name="Grouping"/>
      <component level="1" name="Core"/>
      <meta content="mirror2.x3d" name="title"/>
      <meta content="John Carlson" name="creator"/>
      <meta content="manual" name="generator"/>
      <meta content="https://coderextreme.net/X3DJSONLD/src/main/data/mirror2.x3d"
             name="identifier"/>
      <meta content="a mirrored sphere" name="description"/>
   </head>
   <Scene>
      <Viewpoint description="Switch background and images texture" position="0 5 100"/>
      <Background DEF="cube"
                   backUrl="&#34;../resources/images/all_probes/beach_cross/beach_back.png&#34; &#34;https://coderextreme.net/X3DJSONLD/src/main/resources/images/all_probes/beach_cross/beach_back.png&#34;"
                   bottomUrl="&#34;../resources/images/all_probes/beach_cross/beach_bottom.png&#34; &#34;https://coderextreme.net/X3DJSONLD/src/main/resources/images/all_probes/beach_cross/beach_bottom.png&#34;"
                   frontUrl="&#34;../resources/images/all_probes/beach_cross/beach_front.png&#34; &#34;https://coderextreme.net/X3DJSONLD/src/main/resources/images/all_probes/beach_cross/beach_front.png&#34;"
                   leftUrl="&#34;../resources/images/all_probes/beach_cross/beach_left.png&#34; &#34;https://coderextreme.net/X3DJSONLD/src/main/resources/images/all_probes/beach_cross/beach_left.png&#34;"
                   rightUrl="&#34;../resources/images/all_probes/beach_cross/beach_right.png&#34; &#34;https://coderextreme.net/X3DJSONLD/src/main/resources/images/all_probes/beach_cross/beach_right.png&#34;"
                   topUrl="&#34;../resources/images/all_probes/beach_cross/beach_top.png&#34; &#34;https://coderextreme.net/X3DJSONLD/src/main/resources/images/all_probes/beach_cross/beach_top.png&#34;"/>
      <Transform>
         <Shape>
            <Appearance>
               <Material diffuseColor="0.7 0.7 0.7" specularColor="0.5 0.5 0.5"/>
               <ComposedCubeMapTexture>
                  <ImageTexture DEF="backShader"
                                 url="&#34;../resources/images/all_probes/beach_cross/beach_back.png&#34; &#34;https://coderextreme.net/X3DJSONLD/src/main/resources/images/all_probes/beach_cross/beach_back.png&#34;"/>
                  <ImageTexture DEF="bottomShader"
                                 url="&#34;../resources/images/all_probes/beach_cross/beach_bottom.png&#34; &#34;https://coderextreme.net/X3DJSONLD/src/main/resources/images/all_probes/beach_cross/beach_bottom.png&#34;"/>
                  <ImageTexture DEF="frontShader"
                                 url="&#34;../resources/images/all_probes/beach_cross/beach_front.png&#34; &#34;https://coderextreme.net/X3DJSONLD/src/main/resources/images/all_probes/beach_cross/beach_front.png&#34;"/>
                  <ImageTexture DEF="leftShader"
                                 url="&#34;../resources/images/all_probes/beach_cross/beach_left.png&#34; &#34;https://coderextreme.net/X3DJSONLD/src/main/resources/images/all_probes/beach_cross/beach_left.png&#34;"/>
                  <ImageTexture DEF="rightShader"
                                 url="&#34;../resources/images/all_probes/beach_cross/beach_right.png&#34; &#34;https://coderextreme.net/X3DJSONLD/src/main/resources/images/all_probes/beach_cross/beach_right.png&#34;"/>
                  <ImageTexture DEF="topShader"
                                 url="&#34;../resources/images/all_probes/beach_cross/beach_top.png&#34; &#34;https://coderextreme.net/X3DJSONLD/src/main/resources/images/all_probes/beach_cross/beach_top.png&#34;"/>
               </ComposedCubeMapTexture>
               <ComposedShader DEF="x_ite" language="GLSL"><!--"http://hypertextbook.com/facts/2005/JustinChe.shtml"-->
                  <field accessType="inputOutput"
                          name="chromaticDispertion"
                          type="SFVec3f"
                          value="0.98 1 1.033"/>
                  <field accessType="inputOutput" name="cube" type="SFInt32" value="0"/>
                  <field accessType="inputOutput" name="bias" type="SFFloat" value="0.5"/>
                  <field accessType="inputOutput"
                          name="scale"
                          type="SFFloat"
                          value="0.5"/>
                  <field accessType="inputOutput" name="power" type="SFFloat" value="2"/>
                  <ShaderPart type="VERTEX"
                               url="&#34;../shaders/x_ite.vs&#34; &#34;https://coderextreme.net/X3DJSONLD/src/main/shaders/x_ite.vs&#34;"/>
                  <ShaderPart type="FRAGMENT"
                               url="&#34;../shaders/x_itemix.fs&#34; &#34;https://coderextreme.net/X3DJSONLD/src/main/shaders/x_itemix.fs&#34;"/>
               </ComposedShader>
               <ComposedShader DEF="x3dom" language="GLSL">
                  <field accessType="inputOutput"
                          name="chromaticDispertion"
                          type="SFVec3f"
                          value="0.98 1 1.033"/>
                  <field accessType="inputOutput" name="cube" type="SFInt32" value="0"/>
                  <field accessType="inputOutput" name="bias" type="SFFloat" value="0.5"/>
                  <field accessType="inputOutput"
                          name="scale"
                          type="SFFloat"
                          value="0.5"/>
                  <field accessType="inputOutput" name="power" type="SFFloat" value="2"/>
                  <ShaderPart type="VERTEX"
                               url="&#34;../shaders/x3dom.vs&#34; &#34;https://coderextreme.net/X3DJSONLD/src/main/shaders/x3dom.vs&#34;"/>
                  <ShaderPart type="FRAGMENT"
                               url="&#34;../shaders/mix.fs&#34; &#34;https://coderextreme.net/X3DJSONLD/src/main/shaders/mix.fs&#34;"/>
               </ComposedShader>
            </Appearance>
            <Sphere containerField="geometry" radius="30"/>
         </Shape>
         <Script DEF="UrlSelector" directOutput="true">
            <field accessType="initializeOnly"
                    name="frontUrls"
                    type="MFString"
                    value="&#34;../resources/images/all_probes/beach_cross/beach_front.png&#34; &#34;../resources/images/all_probes/building_cross/building_front.png&#34; &#34;../resources/images/all_probes/campus_cross/campus_front.png&#34; &#34;../resources/images/all_probes/galileo_cross/galileo_front.png&#34; &#34;../resources/images/all_probes/grace_cross/grace_front.png&#34; &#34;../resources/images/all_probes/kitchen_cross/kitchen_front.png&#34; &#34;../resources/images/all_probes/rnl_cross/rnl_front.png&#34; &#34;../resources/images/all_probes/stpeters_cross/stpeters_front.png&#34; &#34;../resources/images/all_probes/uffizi_cross/uffizi_front.png&#34;"/>
            <field accessType="initializeOnly"
                    name="backUrls"
                    type="MFString"
                    value="&#34;../resources/images/all_probes/beach_cross/beach_back.png&#34; &#34;../resources/images/all_probes/building_cross/building_back.png&#34; &#34;../resources/images/all_probes/campus_cross/campus_back.png&#34; &#34;../resources/images/all_probes/galileo_cross/galileo_back.png&#34; &#34;../resources/images/all_probes/grace_cross/grace_back.png&#34; &#34;../resources/images/all_probes/kitchen_cross/kitchen_back.png&#34; &#34;../resources/images/all_probes/rnl_cross/rnl_back.png&#34; &#34;../resources/images/all_probes/stpeters_cross/stpeters_back.png&#34; &#34;../resources/images/all_probes/uffizi_cross/uffizi_back.png&#34;"/>
            <field accessType="initializeOnly"
                    name="leftUrls"
                    type="MFString"
                    value="&#34;../resources/images/all_probes/beach_cross/beach_left.png&#34; &#34;../resources/images/all_probes/building_cross/building_left.png&#34; &#34;../resources/images/all_probes/campus_cross/campus_left.png&#34; &#34;../resources/images/all_probes/galileo_cross/galileo_left.png&#34; &#34;../resources/images/all_probes/grace_cross/grace_left.png&#34; &#34;../resources/images/all_probes/kitchen_cross/kitchen_left.png&#34; &#34;../resources/images/all_probes/rnl_cross/rnl_left.png&#34; &#34;../resources/images/all_probes/stpeters_cross/stpeters_left.png&#34; &#34;../resources/images/all_probes/uffizi_cross/uffizi_left.png&#34;"/>
            <field accessType="initializeOnly"
                    name="rightUrls"
                    type="MFString"
                    value="&#34;../resources/images/all_probes/beach_cross/beach_right.png&#34; &#34;../resources/images/all_probes/building_cross/building_right.png&#34; &#34;../resources/images/all_probes/campus_cross/campus_right.png&#34; &#34;../resources/images/all_probes/galileo_cross/galileo_right.png&#34; &#34;../resources/images/all_probes/grace_cross/grace_right.png&#34; &#34;../resources/images/all_probes/kitchen_cross/kitchen_right.png&#34; &#34;../resources/images/all_probes/rnl_cross/rnl_right.png&#34; &#34;../resources/images/all_probes/stpeters_cross/stpeters_right.png&#34; &#34;../resources/images/all_probes/uffizi_cross/uffizi_right.png&#34;"/>
            <field accessType="initializeOnly"
                    name="topUrls"
                    type="MFString"
                    value="&#34;../resources/images/all_probes/beach_cross/beach_top.png&#34; &#34;../resources/images/all_probes/building_cross/building_top.png&#34; &#34;../resources/images/all_probes/campus_cross/campus_top.png&#34; &#34;../resources/images/all_probes/galileo_cross/galileo_top.png&#34; &#34;../resources/images/all_probes/grace_cross/grace_top.png&#34; &#34;../resources/images/all_probes/kitchen_cross/kitchen_top.png&#34; &#34;../resources/images/all_probes/rnl_cross/rnl_top.png&#34; &#34;../resources/images/all_probes/stpeters_cross/stpeters_top.png&#34; &#34;../resources/images/all_probes/uffizi_cross/uffizi_top.png&#34;"/>
            <field accessType="initializeOnly"
                    name="bottomUrls"
                    type="MFString"
                    value="&#34;../resources/images/all_probes/beach_cross/beach_bottom.png&#34; &#34;../resources/images/all_probes/building_cross/building_bottom.png&#34; &#34;../resources/images/all_probes/campus_cross/campus_bottom.png&#34; &#34;../resources/images/all_probes/galileo_cross/galileo_bottom.png&#34; &#34;../resources/images/all_probes/grace_cross/grace_bottom.png&#34; &#34;../resources/images/all_probes/kitchen_cross/kitchen_bottom.png&#34; &#34;../resources/images/all_probes/rnl_cross/rnl_bottom.png&#34; &#34;../resources/images/all_probes/stpeters_cross/stpeters_bottom.png&#34; &#34;../resources/images/all_probes/uffizi_cross/uffizi_bottom.png&#34;"/>
            <field accessType="outputOnly" name="front_changed" type="MFString"/>
            <field accessType="outputOnly" name="back_changed" type="MFString"/>
            <field accessType="outputOnly" name="left_changed" type="MFString"/>
            <field accessType="outputOnly" name="right_changed" type="MFString"/>
            <field accessType="outputOnly" name="top_changed" type="MFString"/>
            <field accessType="outputOnly" name="bottom_changed" type="MFString"/>
            <field accessType="inputOnly" name="set_fraction" type="SFFloat"/>
            <field accessType="inputOutput" name="old" type="SFInt32" value="-1"/><![CDATA[

ecmascript:
        function set_fraction( f, tm ) {
	    var side = Math.floor(f*frontUrls.length);
	    if (side > frontUrls.length-1) {
	    	side = 0;
	    }
	    if (side != old) {
	    	    // Browser.print(f+\" \"+side);
	    	    old = side;
		    front_changed[0] = frontUrls[side];
		    back_changed[0] = backUrls[side];
		    left_changed[0] = leftUrls[side];
		    right_changed[0] = rightUrls[side];
		    top_changed[0] = topUrls[side];
		    bottom_changed[0] = bottomUrls[side];
            }
        }

]]></Script>
         <TimeSensor DEF="Clock" cycleInterval="45" loop="true"/>
         <ROUTE fromField="fraction_changed"
                 fromNode="Clock"
                 toField="set_fraction"
                 toNode="UrlSelector"/>
         <ROUTE fromField="front_changed"
                 fromNode="UrlSelector"
                 toField="frontUrl"
                 toNode="cube"/>
         <ROUTE fromField="back_changed"
                 fromNode="UrlSelector"
                 toField="backUrl"
                 toNode="cube"/>
         <ROUTE fromField="left_changed"
                 fromNode="UrlSelector"
                 toField="leftUrl"
                 toNode="cube"/>
         <ROUTE fromField="right_changed"
                 fromNode="UrlSelector"
                 toField="rightUrl"
                 toNode="cube"/>
         <ROUTE fromField="top_changed"
                 fromNode="UrlSelector"
                 toField="topUrl"
                 toNode="cube"/>
         <ROUTE fromField="bottom_changed"
                 fromNode="UrlSelector"
                 toField="bottomUrl"
                 toNode="cube"/>
         <ROUTE fromField="front_changed"
                 fromNode="UrlSelector"
                 toField="url"
                 toNode="frontShader"/>
         <ROUTE fromField="back_changed"
                 fromNode="UrlSelector"
                 toField="url"
                 toNode="backShader"/>
         <ROUTE fromField="left_changed"
                 fromNode="UrlSelector"
                 toField="url"
                 toNode="leftShader"/>
         <ROUTE fromField="right_changed"
                 fromNode="UrlSelector"
                 toField="url"
                 toNode="rightShader"/>
         <ROUTE fromField="top_changed"
                 fromNode="UrlSelector"
                 toField="url"
                 toNode="topShader"/>
         <ROUTE fromField="bottom_changed"
                 fromNode="UrlSelector"
                 toField="url"
                 toNode="bottomShader"/>
      </Transform>
   </Scene>
</X3D>
